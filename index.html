<!DOCTYPE html>
<html lang="he">
<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>נביא השקר</title>
    <link rel="icon" href="https://shlomoi10.github.io/navi_sheker/logo.png">
    <style>
        body {
            font-family: 'Heebo', sans-serif;
            direction: rtl;
            text-align: center;
            background: linear-gradient(to right, #ece9e6, #ffffff);
            padding: 20px;
            color: #333;
            position: relative;
        }

        h1 {
            font-size: 2.5em;
            color: #007bff;
            margin-bottom: 10px;
        }

        p {
            font-size: 1.2em;
        }

        input[type="text"], textarea, button {
            font-family: 'Open Sans', sans-serif;
        }

        input[type="text"], textarea {
            width: 80%;
            padding: 12px 20px;
            margin: 10px 0;
            display: inline-block;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 16px;
        }

        button {
            width: 30%;
            background-color: #007bff;
            color: white;
            padding: 8px 12px;
            margin: 8px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

            button:disabled {
                background-color: #aaa;
                cursor: not-allowed;
            }

            button:hover:enabled {
                background-color: #0056b3;
            }

        .hidden {
            display: none;
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

            .tooltip .tooltiptext {
                visibility: hidden;
                width: 220px;
                background-color: black;
                color: #fff;
                text-align: center;
                border-radius: 6px;
                padding: 10px;
                position: absolute;
                z-index: 1;
                bottom: 125%;
                left: 50%;
                margin-left: -110px;
                opacity: 0;
                transition: opacity 0.3s;
                font-size: 14px;
            }

            .tooltip:hover .tooltiptext {
                visibility: visible;
                opacity: 1;
            }

        .info-icon {
            width: 16px;
            height: 16px;
            background-color: #007bff;
            color: white;
            border-radius: 50%;
            display: inline-block;
            text-align: center;
            line-height: 16px;
            font-size: 12px;
            cursor: pointer;
            margin-left: 5px;
        }

        #originalText {
            width: 80%;
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            font-size: 18px;
            transition: opacity 0.5s ease;
            opacity: 0;
        }

            #originalText.visible {
                opacity: 1;
                animation: blink 1s ease-in-out infinite alternate;
            }

        form {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #logo {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 50px;
            height: 50px;
        }

        .error {
            color: red;
            font-size: 14px;
        }

        #tryAgainButton {
            display: none;
            width: 40%;
            background-color: #28a745;
            color: white;
            padding: 8px 12px;
            margin: 8px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

            #tryAgainButton:hover {
                background-color: #218838;
            }

        /* Overlay styles */
        #overlay {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            z-index: 9999;
            text-align: center;
        }

        #overlay-text {
            color: white;
            font-size: 18px;
            margin-top: 10px;
        }

        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 2s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        @keyframes blink {
            0% {
                transform: scale(1);
            }

            100% {
                transform: scale(1.05);
            }
        }

        /* Glitter Trail */
        .glitter-trail {
            position: absolute;
            pointer-events: none;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(255,255,255,0) 70%);
            box-shadow: 0 0 10px 10px rgba(255,255,255,0.5);
            animation: fadeOut 1s forwards;
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: scale(0.5);
            }
        }
    </style>
</head>
<body>
    <header>
        <a href="https://shlomoi10.github.io/navi_sheker/">
            <img id="logo" src="https://shlomoi10.github.io/navi_sheker/logo.png" alt="Wizard Logo">
        </a>
    </header>
    <h1>נביא השקר</h1>
    <p>רוצים לשאול שאלה? תקראו לי</p>
    <p>
        יש לקרוא לי ע"י:
        <span class="tooltip">
            נביא השקר האם תוכל לענות לי?
            <span class="info-icon">i</span>
            <span class="tooltiptext">מידי פעם אפשר לקרוא לי רק עם "נביא השקר". שימו לב לא להגזים, זה מזלזל בי</span>
        </span>
    </p>
    <form id="magicForm">
        <input type="text" id="inputText" autocomplete="off" placeholder=""><br>
        <span id="errorText1" class="error hidden">אתה מזלזל בי</span>
        <span id="errorText2" class="error hidden">יש צורה איך מבקשים</span><br>
        <label for="questionText">ובכן מה השאלה?</label><br>
        <input type="text" id="questionText" autocomplete="off" onkeydown="handleEnter(event)"><br>
        <button type="button" id="revealButton" onclick="revealText()" disabled>תשובה</button>
        <p id="originalText" class="hidden"></p>
        <button type="button" id="tryAgainButton" onclick="resetMagic()">רוצים לנסות שוב?</button>
    </form>

    <!-- Overlay elements -->
    <div id="overlay">
        <div class="loader"></div>
        <div id="overlay-text"></div>
    </div>

    <script>
        const input = document.getElementById('inputText');
        const questionInput = document.getElementById('questionText');
        const originalText = document.getElementById('originalText');
        const revealButton = document.getElementById('revealButton');
        const tryAgainButton = document.getElementById('tryAgainButton');
        const overlayText = document.getElementById('overlay-text');
        const errorText1 = document.getElementById('errorText1');
        const errorText2 = document.getElementById('errorText2');

        let originalContent = '';
        let isMagicMode = false;
        const magicText = 'נביא השקר האם תוכל לענות לי?';
        const randomResponses = [
            'מה אתה רוצה ממני?',
            'לך אני לא עונה',
            'אני נביא שקר, אתם רוצים לשמוע את האמת?',
            'אני עסוק מדי בשבילך',
            'תשובה אחרת',
            'אני נביא אמת, לא שקר. תחפש מישהו אחר',
            'אין לי כח לשאלות מיותרות'
        ];
        const overlayMessages = [
            'הנביא בפעולה...',
            'ביקשת כל כך יפה...',
            'בלי לחץ...'
        ];
        let magicChar = '';

        function isAndroid() {
            return /Android/i.test(navigator.userAgent);
        }

        function adjustForDevice() {
            if (isAndroid()) {
                console.log("מכשיר אנדרואיד זוהה");
                magicChar = '.';
            } else {
                console.log("מחשב זוהה");
                magicChar = '[';
            }
        }

        input.addEventListener('input', (event) => {
            const value = event.target.value;
            const firstChar = value.charAt(0);

            if (!isMagicMode && (firstChar === magicChar || firstChar === '.')) {
                isMagicMode = true;
                originalContent = '';
                input.value = '';
                return;
            }

            if (isMagicMode) {
                originalContent += value.charAt(value.length - 1);
                input.value = magicText.slice(0, originalContent.length);
            }

            toggleRevealButton();
        });

        input.addEventListener('keydown', (event) => {
            if (isMagicMode && event.key === 'Backspace') {
                originalContent = originalContent.slice(0, -1);
                input.value = magicText.slice(0, originalContent.length);
                event.preventDefault();
            }
        });

        questionInput.addEventListener('input', toggleRevealButton);

        function toggleRevealButton() {
            revealButton.disabled = !(input.value.length > 0 && questionInput.value.length > 0);
        }

        function validateInput(value) {
            if (!value.startsWith('נביא השקר')) {
                errorText1.classList.remove('hidden');
                errorText2.classList.add('hidden');
                return false;
            } else if (value !== 'נביא השקר' && value !== 'נביא השקר האם תוכל לענות לי?') {
                errorText1.classList.add('hidden');
                errorText2.classList.remove('hidden');
                return false;
            } else {
                errorText1.classList.add('hidden');
                errorText2.classList.add('hidden');
                return true;
            }
        }

        function revealText() {
            const inputValue = input.value;
            if (!validateInput(inputValue)) {
                originalText.classList.add('hidden');
                return;
            }

            showOverlay();
            setTimeout(function () {
                document.getElementById('overlay').style.display = 'none';
                if (isMagicMode) {
                    originalText.textContent = originalContent;
                } else {
                    originalText.textContent = randomResponses[Math.floor(Math.random() * randomResponses.length)];
                }
                originalText.classList.remove('hidden');
                originalText.classList.add('visible');
                showTryAgainButton();
            }, 2000);
        }

        function showOverlay() {
            overlayText.textContent = overlayMessages[Math.floor(Math.random() * overlayMessages.length)];
            document.getElementById('overlay').style.display = 'block';
        }

        function handleEnter(event) {
            if (event.key === 'Enter' && !revealButton.disabled) {
                revealText();
            }
        }

        function showTryAgainButton() {
            setTimeout(() => {
                tryAgainButton.style.display = 'block';
            }, 3500);
        }

        function resetMagic() {
            input.value = '';
            questionInput.value = '';
            originalText.textContent = '';
            originalText.classList.remove('visible');
            originalText.classList.add('hidden');
            tryAgainButton.style.display = 'none';
            isMagicMode = false;
            originalContent = '';
            toggleRevealButton();
        }

        adjustForDevice();

        // Glitter trail effect
        document.addEventListener('mousemove', function (e) {
            const glitter = document.createElement('div');
            glitter.className = 'glitter-trail';
            glitter.style.top = `${e.clientY}px`;
            glitter.style.left = `${e.clientX}px`;
            document.body.appendChild(glitter);
            setTimeout(() => {
                glitter.remove();
            }, 1000);
        });
    </script>
</body>
</html>
